<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extract spectra for feature groups — featureGroupSpectra • CompMetaboTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Extract spectra for feature groups — featureGroupSpectra" />
<meta property="og:description" content="featureGroupSpectra allows to extract a Spectrum object for each feature
group in x. Based on the specified function FUN different types of
spectra can be returned:
featureGroupPseudoSpectrum creates a pseudo spectrum based on the
feature values (defined by value) of all features within a feature group
(i.e. each feature is represented as a mass peak in the resulting
spectrum). The reported m/z values will be the &quot;mzmed&quot; of the respective
feature from the featureDefinitions() data frame. The associated
intensity is calculated from the values of the features from the feature
group: by default, for each feature, the median intensity across all
samples part of subset is reported. Parameters value and filled are
passed to the internal call to featureValues() that returns the features'
values which are used in these calculations. Parameter n allows to
further restrict the samples being considered in the calculations: for each
feature group samples are first ordered by the sum of signal of the
features of the group and then only the top n samples are used in the
calculations.
Examples:
To report the mean intensity of each feature in the 10 samples with the
highest signal for the feature group use n = 10 and
intensityFun = mean. The m/z values reported in the Spectrum object
of a feature group will be the &quot;mzmed&quot; of the features, the intensity
values the mean intensity (value = &quot;maxo&quot;) across the 10 samples with
the highest signal for that feature group.
To report the maximal intensity (value = &quot;maxo&quot; of each feature in
samples 1, 4, 8 and 10 use subset = c(1, 4, 8, 10) and
intensityFun = max. More examples in the examples section.
featureGroupFullScan: reports the full MS1 spectrum (full scan) in the
sample with the highest total signal (defined by value) for the feature
group at the retention time closest to the median &quot;rtmed&quot; across all
features of the feature group.

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CompMetaboTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/LC-MS-feature-grouping.html">LC-MS feature grouping</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EuracBiomedicalResearch/CompMetaboTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract spectra for feature groups</h1>
    <small class="dont-index">Source: <a href='https://github.com/EuracBiomedicalResearch/CompMetaboTools/blob/master/R/group_feature_methods.R'><code>R/group_feature_methods.R</code></a></small>
    <div class="hidden name"><code>featureGroupSpectra.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>featureGroupSpectra</code> allows to extract a <code>Spectrum</code> object for each feature
group in <code>x</code>. Based on the specified function <code>FUN</code> different <em>types</em> of
spectra can be returned:</p><ul>
<li><p><code>featureGroupPseudoSpectrum</code> creates a <em>pseudo</em> spectrum based on the
feature values (defined by <code>value</code>) of all features within a feature group
(i.e. each feature is represented as a mass peak in the resulting
spectrum). The reported m/z values will be the <code>"mzmed"</code> of the respective
feature from the <code>featureDefinitions()</code> data frame. The associated
intensity is calculated from the values of the features from the feature
group: by default, for each feature, the median intensity across all
samples part of <code>subset</code> is reported. Parameters <code>value</code> and <code>filled</code> are
passed to the internal call to <code>featureValues()</code> that returns the features'
values which are used in these calculations. Parameter <code>n</code> allows to
further restrict the samples being considered in the calculations: for each
feature group samples are first ordered by the sum of signal of the
features of the group and then only the <em>top n</em> samples are used in the
calculations.</p>
<p>Examples:
To report the mean intensity of each feature in the 10 samples with the
highest signal for the feature group use <code>n = 10</code> and
<code>intensityFun = mean</code>. The m/z values reported in the <code>Spectrum</code> object
of a feature group will be the <code>"mzmed"</code> of the features, the intensity
values the mean intensity (<code>value = "maxo"</code>) across the 10 samples with
the highest signal for that feature group.</p>
<p>To report the maximal intensity (<code>value = "maxo"</code> of each feature in
samples 1, 4, 8 and 10 use <code>subset = c(1, 4, 8, 10)</code> and
<code>intensityFun = max</code>. More examples in the examples section.</p></li>
<li><p><code>featureGroupFullScan</code>: reports the full MS1 spectrum (full scan) in the
sample with the highest total signal (defined by <code>value</code>) for the feature
group at the retention time closest to the median <code>"rtmed"</code> across all
features of the feature group.</p></li>
</ul>

    </div>

    <pre class="usage"><span class='fu'>featureGroupSpectra</span><span class='op'>(</span>
  <span class='va'>x</span>,
  featureGroup <span class='op'>=</span> <span class='fu'>featureGroups</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  FUN <span class='op'>=</span> <span class='va'>featureGroupPseudoSpectrum</span>,
  value <span class='op'>=</span> <span class='st'>"maxo"</span>,
  filled <span class='op'>=</span> <span class='cn'>TRUE</span>,
  subset <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='fu'>fileNames</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>featureGroupPseudoSpectrum</span><span class='op'>(</span>
  featureGroup <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>x</span>,
  fvals <span class='op'>=</span> <span class='fu'>featureValues</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>fvals</span><span class='op'>)</span>,
  intensityFun <span class='op'>=</span> <span class='va'>median</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>featureGroupFullScan</span><span class='op'>(</span>
  featureGroup <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>x</span>,
  fvals <span class='op'>=</span> <span class='fu'>featureValues</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code>XCMSnExp()</code> object with available <code>featureGroups()</code>.</p></td>
    </tr>
    <tr>
      <th>featureGroup</th>
      <td><p><code>character</code> with the IDs of the feature group(s) for
which the spectra should be returned. Defaults to all feature groups
defined in <code>x</code>. Only <code>featureGroupSpectra</code> supports
<code><a href='https://rdrr.io/r/base/length.html'>length(featureGroup)</a></code> to be of length &gt; 1.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p><code>function</code> to be used to define the spectrum for each feature
group. Can be <code>featureGroupPseudoSpectrum</code>, <code>featureGroupFullScan</code> or
any function taking parameters <code>featureGroup</code>, <code>x</code>, <code>fvals</code>.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> specifying the column in <code>chromPeaks</code> matrix to
be used as <em>feature values</em> for each feature. This parameter is passed
to the <code>featureValues()</code> call.</p></td>
    </tr>
    <tr>
      <th>filled</th>
      <td><p>for <code>featureGroupPseudoSpectra</code>: <code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether
filled-in values should also be considered. See <code>featureValues()</code> for
details.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p><code>integer</code> with indices of specific samples if spectra should
only be defined on a subset of samples. See description section for
details.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional parameters passed down to the function specifyed with
<code>FUN</code>.</p></td>
    </tr>
    <tr>
      <th>fvals</th>
      <td><p>for <code>featureGroupPseudoSpectra</code> and <code>featureGroupFullScan</code>:
<code>matrix</code> with feature values (rows being features and columns samples)
such as returned by <code>featureValues()</code>.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>for <code>featureGroupPseudoSpectra</code>: <code><a href='https://rdrr.io/r/base/integer.html'>integer(1)</a></code> defining the <em>top n</em>
samples (in <code>subset</code>) on which spectra should be defined. Samples are
ordered based on the sum of signal (defined by parameter <code>value</code>) from
the features of each feature group. See description section for more
details.</p></td>
    </tr>
    <tr>
      <th>intensityFun</th>
      <td><p>for <code>featureGroupPseudoSpectra</code>: <code>function</code> that should
be applied across samples (defined by <code>subset</code>) of the feature value
matrix to calculate the intensity for each mass peak of the returned
pseudo spectrum. By default (<code>intensityFun = median</code>) the median
intensity of a feature across all samples (defined by <code>subset</code> and <code>n</code>)
is used. See description section for examples.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>for <code>featureGroupSpectra</code>: <code>MSpectra</code> object of length equal to the
number of feature groups in <code>x</code> and each element being one spectrum.
For all other functions: a <code>Spectrum</code> object.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Load test data set from xcms</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/sneumann/xcms'>xcms</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: Biobase</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: BiocGenerics</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: parallel</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘BiocGenerics’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:parallel’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span>
#&gt; <span class='message'>    clusterExport, clusterMap, parApply, parCapply, parLapply,</span>
#&gt; <span class='message'>    parLapplyLB, parRapply, parSapply, parSapplyLB</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    IQR, mad, sd, var, xtabs</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    anyDuplicated, append, as.data.frame, basename, cbind, colnames,</span>
#&gt; <span class='message'>    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,</span>
#&gt; <span class='message'>    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,</span>
#&gt; <span class='message'>    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,</span>
#&gt; <span class='message'>    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,</span>
#&gt; <span class='message'>    union, unique, unsplit, which.max, which.min</span></div><div class='output co'>#&gt; <span class='message'>Welcome to Bioconductor</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    Vignettes contain introductory material; view with</span>
#&gt; <span class='message'>    'browseVignettes()'. To cite Bioconductor, see</span>
#&gt; <span class='message'>    'citation("Biobase")', and for packages 'citation("pkgname")'.</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: BiocParallel</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: MSnbase</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: mzR</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: Rcpp</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: S4Vectors</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: stats4</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘S4Vectors’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    expand.grid, I, unname</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: ProtGenerics</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘ProtGenerics’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    smooth</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>This is MSnbase version 2.17.3 </span>
#&gt; <span class='message'>  Visit https://lgatto.github.io/MSnbase/ to get started.</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘MSnbase’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    trimws</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>This is xcms version 3.13.4 </span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘xcms’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    sigma</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>faahko_sub</span><span class='op'>)</span>
<span class='co'>## Update the path to the files for the local system</span>
<span class='fu'><a href='https://rdrr.io/pkg/xcms/man/dirname.html'>dirname</a></span><span class='op'>(</span><span class='va'>faahko_sub</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"cdf/KO/"</span>, package <span class='op'>=</span> <span class='st'>"faahKO"</span><span class='op'>)</span>

<span class='co'>## Perform correspondence analysis</span>
<span class='va'>xdata</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/groupChromPeaks.html'>groupChromPeaks</a></span><span class='op'>(</span><span class='va'>faahko_sub</span>,
    param <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/groupChromPeaks-density.html'>PeakDensityParam</a></span><span class='op'>(</span>sampleGroup <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Processing 2572 mz slices ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='co'>## Group features</span>
<span class='va'>xdata</span> <span class='op'>&lt;-</span> <span class='fu'>groupFeatures</span><span class='op'>(</span><span class='va'>xdata</span>, param <span class='op'>=</span> <span class='fu'>SimilarRtimeParam</span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>xdata</span> <span class='op'>&lt;-</span> <span class='fu'>groupFeatures</span><span class='op'>(</span><span class='va'>xdata</span>,
    param <span class='op'>=</span> <span class='fu'><a href='groupFeatures-abundance-correlation.html'>AbundanceCorrelationParam</a></span><span class='op'>(</span>threshold <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'>featureGroups</span><span class='op'>(</span><span class='va'>xdata</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; FG.003.002 FG.004.002 FG.005.002 FG.006.001 FG.006.002 FG.011.001 FG.012.001 
#&gt;          1          1          1          1          1          1          1 
#&gt; FG.013.001 FG.014.001 FG.015.001 FG.016.001 FG.017.001 FG.018.001 FG.019.001 
#&gt;          1          1          1          1          1          1          1 
#&gt; FG.020.001 FG.021.001 FG.022.001 FG.023.001 FG.024.001 FG.025.001 FG.026.001 
#&gt;          1          1          1          1          1          1          1 
#&gt; FG.027.001 FG.028.001 FG.029.001 FG.030.001 FG.031.001 FG.032.001 FG.033.001 
#&gt;          1          1          1          1          1          1          1 
#&gt; FG.001.001 FG.002.001 FG.003.001 FG.005.001 FG.007.001 FG.008.001 FG.009.001 
#&gt;          2          2          2          2          2          2          2 
#&gt; FG.010.001 FG.004.001 
#&gt;          2          3 </div><div class='input'>
<span class='co'>################</span>
<span class='co'>## featureGroupSpectra</span>
<span class='co'>##</span>

<span class='co'>## Get a pseudo spectrum for each feature group</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>featureGroupSpectra</span><span class='op'>(</span><span class='va'>xdata</span><span class='op'>)</span>
<span class='va'>res</span>
</div><div class='output co'>#&gt; MSpectra with 37 spectra and 2 metadata column(s):
#&gt;        msLevel     rtime peaksCount | feature_group      feature_id
#&gt;      &lt;integer&gt; &lt;numeric&gt;  &lt;integer&gt; |   &lt;character&gt; &lt;CharacterList&gt;
#&gt;    1         1   2787.77          3 |    FG.004.001  FT01,FT04,FT46
#&gt;    2         1   3254.90          1 |    FG.011.001            FT02
#&gt;    3         1   3387.14          1 |    FG.003.002            FT03
#&gt;    4         1   2994.34          1 |    FG.012.001            FT05
#&gt;    5         1   2923.92          1 |    FG.013.001            FT06
#&gt;   ..       ...       ...        ... .           ...             ...
#&gt;   33         1   3482.61          1 |    FG.029.001            FT42
#&gt;   34         1   3580.41          1 |    FG.030.001            FT43
#&gt;   35         1   3712.65          1 |    FG.031.001            FT44
#&gt;   36         1   2918.44          1 |    FG.032.001            FT45
#&gt;   37         1   3707.18          1 |    FG.033.001            FT47</div><div class='input'>
<span class='co'>## Get a full scan spectrum for a subset of the feature groups</span>
<span class='co'>## considering only the subset of the last two samples</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>featureGroupSpectra</span><span class='op'>(</span><span class='va'>xdata</span>,
    featureGroup <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'>featureGroups</span><span class='op'>(</span><span class='va'>xdata</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>,
    FUN <span class='op'>=</span> <span class='va'>featureGroupFullScan</span>, subset <span class='op'>=</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span>
<span class='va'>res</span>
</div><div class='output co'>#&gt; MSpectra with 4 spectra and 2 metadata column(s):
#&gt;       msLevel     rtime peaksCount | feature_group      feature_id
#&gt;     &lt;integer&gt; &lt;numeric&gt;  &lt;integer&gt; |   &lt;character&gt; &lt;CharacterList&gt;
#&gt;   1         1   2787.77        421 |    FG.004.001  FT01,FT04,FT46
#&gt;   2         1   3254.12        410 |    FG.011.001            FT02
#&gt;   3         1   3387.14        404 |    FG.003.002            FT03
#&gt;   4         1   2994.34        410 |    FG.012.001            FT05</div><div class='input'>
<span class='co'>################</span>
<span class='co'>## Pseudo Spectrum</span>
<span class='co'>##</span>

<span class='co'>## Get the pseudo spectrum for one feature group reporting the per-feature</span>
<span class='co'>## maximal "maxo" value across samples as the spectrum's intensities</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>featureGroupPseudoSpectrum</span><span class='op'>(</span>featureGroup <span class='op'>=</span> <span class='st'>"FG.010.001"</span>, <span class='va'>xdata</span>,
    fvals <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/XCMSnExp-peak-grouping-results.html'>featureValues</a></span><span class='op'>(</span><span class='va'>xdata</span>, value <span class='op'>=</span> <span class='st'>"maxo"</span><span class='op'>)</span>, intensityFun <span class='op'>=</span> <span class='va'>max</span><span class='op'>)</span>

<span class='fu'>intensity</span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   FT10   FT11 
#&gt; 232896  50504 </div><div class='input'><span class='fu'>mz</span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 326.2 327.2</div><div class='input'>
<span class='co'>## Get the pseudo spectrum using the values in the one sample with the</span>
<span class='co'>## highest total sum of signal ("maxo") for the feature group.</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>featureGroupPseudoSpectrum</span><span class='op'>(</span>featureGroup <span class='op'>=</span> <span class='st'>"FG.010.001"</span>, <span class='va'>xdata</span>,
    fvals <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/XCMSnExp-peak-grouping-results.html'>featureValues</a></span><span class='op'>(</span><span class='va'>xdata</span>, value <span class='op'>=</span> <span class='st'>"maxo"</span><span class='op'>)</span>, n <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='fu'>intensity</span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   FT10   FT11 
#&gt; 232896  50504 </div><div class='input'><span class='fu'>mz</span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 326.2 327.2</div><div class='input'>

<span class='co'>################</span>
<span class='co'>## Full Scan Spectrum</span>
<span class='co'>##</span>

<span class='co'>## Get the full MS1 spectrum from the sample with the highest total signal</span>
<span class='co'>## of one specific feature group</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>featureGroupFullScan</span><span class='op'>(</span>featureGroup <span class='op'>=</span> <span class='st'>"FG.010.001"</span>, <span class='va'>xdata</span>,
    fvals <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/XCMSnExp-peak-grouping-results.html'>featureValues</a></span><span class='op'>(</span><span class='va'>xdata</span>, value <span class='op'>=</span> <span class='st'>"maxo"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>mz</span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>, <span class='fu'>intensity</span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"h"</span>, xlab <span class='op'>=</span> <span class='st'>"m/z"</span>, ylab <span class='op'>=</span> <span class='st'>"intensity"</span><span class='op'>)</span>
</div><div class='input'><span class='co'>## Highlight the peaks for the features of the group.</span>
<span class='va'>idx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'>featureGroups</span><span class='op'>(</span><span class='va'>xdata</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"FG.001.001"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html'>featureDefinitions</a></span><span class='op'>(</span><span class='va'>xdata</span><span class='op'>)</span><span class='op'>$</span><span class='va'>mzmed</span><span class='op'>[</span><span class='va'>idx</span><span class='op'>]</span>,
    y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>idx</span><span class='op'>)</span><span class='op'>)</span>, pch <span class='op'>=</span> <span class='fl'>4</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</div><div class='img'><img src='featureGroupSpectra-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Johannes Rainer, Mar Garcia-Aloy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


