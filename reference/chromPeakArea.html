<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get MS peak area (m/z and rt range) for chromatographic peaks — chromPeakArea • CompMetaboTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Get MS peak area (m/z and rt range) for chromatographic peaks — chromPeakArea" />
<meta property="og:description" content="Extract the peak area (defined by the m/z and retention time range) of
chromatographic peaks. The chromatographic peaks can be defined by their ID
(i.e. rownames of the chromPeaks matrix) or by m/z and a retention times.
The function identifies first chromatographic peaks in x that match the
input parameters mz and rt or peakId and then defines the m/z and rt
range based on the &quot;mzmin&quot;, &quot;mzmax&quot;, &quot;rtmin&quot; and &quot;rtmax&quot; of these.
If m/z and rt ranges are provided, only chromatographic peaks are considered
that have their apex within the region.
As a result a matrix is returned with columns &quot;mzmin&quot;, &quot;mzmax&quot;,
&quot;rtmin&quot; and &quot;rtmax&quot; defining the lower and upper boundaries of the
region of the peaks. Each row in this matrix represent the result for one
element in the input parameter specifying the peaks of interest (e.g. mz,
rt or peakId)." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CompMetaboTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/LC-MS-feature-grouping.html">LC-MS feature grouping</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EuracBiomedicalResearch/CompMetaboTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get MS peak area (m/z and rt range) for chromatographic peaks</h1>
    <small class="dont-index">Source: <a href='https://github.com/EuracBiomedicalResearch/CompMetaboTools/blob/master/R/chromPeakArea.R'><code>R/chromPeakArea.R</code></a></small>
    <div class="hidden name"><code>chromPeakArea.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extract the peak area (defined by the m/z and retention time range) of
chromatographic peaks. The chromatographic peaks can be defined by their ID
(i.e. rownames of the <code>chromPeaks</code> matrix) or by m/z and a retention times.</p>
<p>The function identifies first chromatographic peaks in <code>x</code> that match the
input parameters <code>mz</code> and <code>rt</code> or <code>peakId</code> and then defines the m/z and rt
range based on the <code>"mzmin"</code>, <code>"mzmax"</code>, <code>"rtmin"</code> and <code>"rtmax"</code> of these.
If m/z and rt ranges are provided, only chromatographic peaks are considered
that have their apex within the region.</p>
<p>As a result a <code>matrix</code> is returned with columns <code>"mzmin"</code>, <code>"mzmax"</code>,
<code>"rtmin"</code> and <code>"rtmax"</code> defining the lower and upper boundaries of the
region of the peaks. Each row in this matrix represent the result for one
element in the input parameter specifying the peaks of interest (e.g. <code>mz</code>,
<code>rt</code> or <code>peakId</code>).</p>
    </div>

    <pre class="usage"><span class='fu'>chromPeakArea</span><span class='op'>(</span>
  <span class='va'>x</span>,
  mz <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='op'>)</span>,
  rt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='op'>)</span>,
  diffRt <span class='op'>=</span> <span class='fl'>40</span>,
  ppm <span class='op'>=</span> <span class='fl'>50</span>,
  peakId <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code>XCMSnExp</code> object with identified chromatographic peaks.</p></td>
    </tr>
    <tr>
      <th>mz</th>
      <td><p><code>numeric</code> or <code>matrix</code> with m/z values to identify chromatographic
peaks from which regions should be extracted. If a <code>matrix</code> is provided
it is expeted to have 2 columns with the lower and upper m/z boundary. If
a <code>numeric</code> is provided parameter <code>ppm</code> is also considered.</p></td>
    </tr>
    <tr>
      <th>rt</th>
      <td><p><code>numeric</code> or <code>matrix</code> with retention time values to identify
chromatographic peaks from which the peak areas are supposed to be
defined. If a <code>matrix</code> is provided it is expected to be a two column
matrix with the lower and upper rt boundary in which chromatographic
peaks should be found. If a <code>numeric</code> is provided, parameter <code>diffRt</code>
is considered to define the rt region to search for peaks.</p></td>
    </tr>
    <tr>
      <th>diffRt</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> to define the rt region in which peaks should be
identified if a <code>numeric</code> is provided with parameter <code>rt</code>. The rt region
is defined as <code>rt - diffRt</code> to <code>rt + diffRt</code>.</p></td>
    </tr>
    <tr>
      <th>ppm</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> to define the m/z region in which peaks should be
identified if <code>mz</code> is a <code>numeric</code>. The m/z region is defined as
<code>mz - ppm(mz, ppm)</code> to <code>mz + ppm(mz, ppm)</code></p></td>
    </tr>
    <tr>
      <th>peakId</th>
      <td><p><code>character</code> with the IDs of the chromatographic peaks (i.e.
rownames of <code>chromPeaks(object)</code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>matrix</code> with columnd <code>"mzmin"</code>, <code>"mzmax"</code>, <code>"rtmin"</code>, <code>"rtmax"</code>
with the m/z and retention time ranges calculated on all chromatographic
peaks in <code>x</code> matching <code>mz</code> and <code>rt</code>. Each row representing the result for
each value in <code>mz</code> and <code>rt</code>.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://dx.doi.org/10.1021/bi0480335'>faahKO</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: xcms</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: BiocParallel</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: MSnbase</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: BiocGenerics</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: parallel</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘BiocGenerics’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:parallel’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span>
#&gt; <span class='message'>    clusterExport, clusterMap, parApply, parCapply, parLapply,</span>
#&gt; <span class='message'>    parLapplyLB, parRapply, parSapply, parSapplyLB</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    IQR, mad, sd, var, xtabs</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    anyDuplicated, append, as.data.frame, basename, cbind, colnames,</span>
#&gt; <span class='message'>    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,</span>
#&gt; <span class='message'>    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,</span>
#&gt; <span class='message'>    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,</span>
#&gt; <span class='message'>    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,</span>
#&gt; <span class='message'>    union, unique, unsplit, which.max, which.min</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: Biobase</span></div><div class='output co'>#&gt; <span class='message'>Welcome to Bioconductor</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    Vignettes contain introductory material; view with</span>
#&gt; <span class='message'>    'browseVignettes()'. To cite Bioconductor, see</span>
#&gt; <span class='message'>    'citation("Biobase")', and for packages 'citation("pkgname")'.</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: mzR</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: Rcpp</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: S4Vectors</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: stats4</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘S4Vectors’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    expand.grid, I, unname</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: ProtGenerics</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘ProtGenerics’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    smooth</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>This is MSnbase version 2.17.8 </span>
#&gt; <span class='message'>  Visit https://lgatto.github.io/MSnbase/ to get started.</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘MSnbase’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    trimws</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>This is xcms version 3.13.5 </span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘xcms’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    sigma</span></div><div class='input'><span class='va'>fls</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>'cdf/KO/ko15.CDF'</span>, package <span class='op'>=</span> <span class='st'>"faahKO"</span><span class='op'>)</span>,
         <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>'cdf/KO/ko16.CDF'</span>, package <span class='op'>=</span> <span class='st'>"faahKO"</span><span class='op'>)</span>,
         <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>'cdf/WT/wt19.CDF'</span>, package <span class='op'>=</span> <span class='st'>"faahKO"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>od</span> <span class='op'>&lt;-</span> <span class='fu'>readMSData</span><span class='op'>(</span><span class='va'>fls</span>, mode <span class='op'>=</span> <span class='st'>"onDisk"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span></div><div class='input'><span class='va'>xod</span> <span class='op'>&lt;-</span> <span class='fu'>findChromPeaks</span><span class='op'>(</span>
   <span class='va'>od</span>, param <span class='op'>=</span> <span class='fu'>CentWaveParam</span><span class='op'>(</span>noise <span class='op'>=</span> <span class='fl'>10000</span>, snthresh <span class='op'>=</span> <span class='fl'>40</span>,
                             prefilter <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>10000</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Detecting mass traces at 25 ppm ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Detecting chromatographic peaks in 937 regions of interest ...</span></div><div class='output co'>#&gt; <span class='message'> OK: 87 found.</span></div><div class='output co'>#&gt; <span class='message'>Detecting mass traces at 25 ppm ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Detecting chromatographic peaks in 1025 regions of interest ...</span></div><div class='output co'>#&gt; <span class='message'> OK: 100 found.</span></div><div class='output co'>#&gt; <span class='message'>Detecting mass traces at 25 ppm ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Detecting chromatographic peaks in 623 regions of interest ...</span></div><div class='output co'>#&gt; <span class='message'> OK: 71 found.</span></div><div class='input'>
<span class='fu'>chromPeakArea</span><span class='op'>(</span><span class='va'>xod</span>, rt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2500</span>, <span class='fl'>2700</span><span class='op'>)</span>, diffRt <span class='op'>=</span> <span class='fl'>100</span>,
    mz <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>400</span>, <span class='fl'>300</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>500</span>, <span class='fl'>400</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      mzmin mzmax    rtmin    rtmax
#&gt; [1,] 453.2 476.2 2501.378 2632.834
#&gt; [2,] 301.0 384.1 2592.145 2819.063</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Johannes Rainer, Mar Garcia-Aloy.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9000.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


