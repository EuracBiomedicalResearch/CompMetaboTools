<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a stacked plot of multiple chromatograms — joyPlot • CompMetaboTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a stacked plot of multiple chromatograms — joyPlot" />
<meta property="og:description" content="The joyPlot function creates a stacked plot of chromatograms of a
single sample (parameter sample). The name joyPlot was chosen as the
created plot can, depending on the data, look similar to the cover of the
Unknown Pleasures album
of the band Joy Division.
The method is implemented for XCMSnExp and MChromatograms
objects:
For object being an MChromatograms: the function plots all
chromatograms stacked (overlappingly) on top of each others assuming that
the chromatograms are ordered by m/z (i.e. first row having the smallest,
last row the largest m/z).
For object being an XCMSnExp: the function will plot only
chromatograms for chromatographic peaks present in the specified m/z range
(parameter mz) and retention time range (parameter rt) in the sample
sample.

" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CompMetaboTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/LC-MS-feature-grouping.html">LC-MS feature grouping</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EuracBiomedicalResearch/CompMetaboTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a stacked plot of multiple chromatograms</h1>
    <small class="dont-index">Source: <a href='https://github.com/EuracBiomedicalResearch/CompMetaboTools/blob/master/R/joyPlot.R'><code>R/joyPlot.R</code></a></small>
    <div class="hidden name"><code>joyPlot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>joyPlot</code> function creates a stacked plot of chromatograms of a
single sample (parameter <code>sample</code>). The name <code>joyPlot</code> was chosen as the
created plot can, depending on the data, look similar to the cover of the
<a href='https://en.wikipedia.org/wiki/Unknown_Pleasures'>Unknown Pleasures</a> album
of the band Joy Division.</p>
<p>The method is implemented for <a href='https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html'>XCMSnExp</a> and <a href='https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html'>MChromatograms</a>
objects:</p><ul>
<li><p>For <code>object</code> being an <a href='https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html'>MChromatograms</a>: the function plots all
chromatograms stacked (overlappingly) on top of each others assuming that
the chromatograms are ordered by m/z (i.e. first row having the smallest,
last row the largest m/z).</p></li>
<li><p>For <code>object</code> being an <a href='https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html'>XCMSnExp</a>: the function will plot only
chromatograms for chromatographic peaks present in the specified m/z range
(parameter <code>mz</code>) and retention time range (parameter <code>rt</code>) in the sample
<code>sample</code>.</p></li>
</ul>

    </div>

    <pre class="usage"><span class='co'># S4 method for MChromatograms</span>
<span class='fu'>joyPlot</span><span class='op'>(</span>
  <span class='va'>object</span>,
  sample <span class='op'>=</span> <span class='fl'>1</span>,
  yoffset <span class='op'>=</span> <span class='fl'>0.3</span>,
  xlim <span class='op'>=</span> <span class='cn'>NULL</span>,
  ylim <span class='op'>=</span> <span class='cn'>NULL</span>,
  col <span class='op'>=</span> <span class='st'>"#000000"</span>,
  peakBg <span class='op'>=</span> <span class='st'>"#ffffffaa"</span>,
  type <span class='op'>=</span> <span class='st'>"l"</span>,
  ylab <span class='op'>=</span> <span class='st'>""</span>,
  xlab <span class='op'>=</span> <span class='st'>"retention time"</span>,
  spacing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"relative"</span>, <span class='st'>"equal"</span><span class='op'>)</span>,
  legend <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>joyPlot</span><span class='op'>(</span>
  <span class='va'>object</span>,
  sample <span class='op'>=</span> <span class='fl'>1L</span>,
  mz <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='cn'>Inf</span>, <span class='cn'>Inf</span><span class='op'>)</span>,
  rt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='cn'>Inf</span>, <span class='cn'>Inf</span><span class='op'>)</span>,
  yoffset <span class='op'>=</span> <span class='fl'>0.3</span>,
  col <span class='op'>=</span> <span class='st'>"#000000"</span>,
  peakBg <span class='op'>=</span> <span class='st'>"#ffffffaa"</span>,
  type <span class='op'>=</span> <span class='st'>"l"</span>,
  ylab <span class='op'>=</span> <span class='st'>""</span>,
  xlab <span class='op'>=</span> <span class='st'>"retention time"</span>,
  spacing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"relative"</span>, <span class='st'>"equal"</span><span class='op'>)</span>,
  legend <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>an <a href='https://lgatto.github.io/MSnbase/reference/MChromatograms-class.html'>MChromatograms</a> or <a href='https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html'>XCMSnExp</a> object.</p></td>
    </tr>
    <tr>
      <th>sample</th>
      <td><p><code><a href='https://rdrr.io/r/base/integer.html'>integer(1)</a></code> defining the sample (column in <code>x</code>) from which the
plot should be created.</p></td>
    </tr>
    <tr>
      <th>yoffset</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the proportion of the y-axis to be used
for the stacked chromatograms. The default value of <code>yoffset = 0.3</code> uses
30% of the y axis to place the individual chromatograms (eiher equally
spaced or relative to their m/z). This value is relative to the largest
intensity value of all chromatograms.</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p>optional <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> defining the x-axis limits.</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>optional <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> defining the y-axis limits.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>color of the lines used to draw the chromatograms. Can be of
length 1 or equal <code><a href='https://rdrr.io/r/base/nrow.html'>nrow(x)</a></code>.</p></td>
    </tr>
    <tr>
      <th>peakBg</th>
      <td><p>background color for the chromatograms. Can be of length 1
or equal <code><a href='https://rdrr.io/r/base/nrow.html'>nrow(x)</a></code>.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> defining the plot type (see parameter <code>type</code> in
base <code><a href='https://lgatto.github.io/MSnbase/reference/plot-methods.html'>plot()</a></code>.</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> with the y-axis label.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> with the x-axis label.</p></td>
    </tr>
    <tr>
      <th>spacing</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> defining whether the chromatograms should be
placed on the y-axis relative to their m/z value (spacing = "relative")
or equally spaced (spacing = "equal").</p></td>
    </tr>
    <tr>
      <th>legend</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether m/z values should be displayed next to
the chromatograms.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments to be passed to the <code>plot</code> function.</p></td>
    </tr>
    <tr>
      <th>mz</th>
      <td><p>for <code>object</code> being an <code>XCMSnExp</code>: <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> defining the lower
and upper m/z of the m/z range.</p></td>
    </tr>
    <tr>
      <th>rt</th>
      <td><p>for <code>object</code> being an <code>XCMSnExp</code>: <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> defining the
retention time range.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>besides creating the plot the function returns (invisibly) the
y positions of the individual chromatograms.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/sneumann/xcms'>xcms</a></span><span class='op'>)</span>

<span class='co'>## Load a test data set with detected peaks</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>faahko_sub</span><span class='op'>)</span>
<span class='co'>## Update the path to the files for the local system</span>
<span class='fu'><a href='https://rdrr.io/pkg/xcms/man/dirname.html'>dirname</a></span><span class='op'>(</span><span class='va'>faahko_sub</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"cdf/KO"</span>, package <span class='op'>=</span> <span class='st'>"faahKO"</span><span class='op'>)</span>

<span class='va'>one</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/MSnExp-class.html'>filterFile</a></span><span class='op'>(</span><span class='va'>faahko_sub</span>, <span class='fl'>1L</span><span class='op'>)</span>

<span class='co'>## Plot stacked chromatograms for m/z slices containing chromatographic peaks</span>
<span class='fu'>joyPlot</span><span class='op'>(</span><span class='va'>one</span>, rt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4000</span>, <span class='fl'>4200</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='joyPlot-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Plot the chromatograms equally spaced and showing also their m/z</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>joyPlot</span><span class='op'>(</span><span class='va'>one</span>, rt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4000</span>, <span class='fl'>4200</span><span class='op'>)</span>, spacing <span class='op'>=</span> <span class='st'>"equal"</span>, legend <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='joyPlot-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## joyPlot returns the y position of the slices/chromatograms</span>
<span class='va'>res</span>
</div><div class='output co'>#&gt; [1]      0.00  19586.74  39173.49  58760.23  78346.97  97933.71 117520.46
#&gt; [8] 137107.20</div><div class='input'>
<span class='co'>## Disable transparency of individual peaks</span>
<span class='fu'>joyPlot</span><span class='op'>(</span><span class='va'>one</span>, rt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4000</span>, <span class='fl'>4200</span><span class='op'>)</span>, spacing <span class='op'>=</span> <span class='st'>"equal"</span>, peakBg <span class='op'>=</span> <span class='st'>"#ffffff"</span><span class='op'>)</span>
</div><div class='img'><img src='joyPlot-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## To create a joy plot for the full data, not just the slices containing</span>
<span class='co'>## chromatographic peaks we have to first extract the respective</span>
<span class='co'>## chromatograms from the data. Below we define thus the m/z slices - with</span>
<span class='co'>## a rather large m/z range for each (i.e. of 1) in the m/z range 400 - 500</span>
<span class='va'>mzs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>400</span>, <span class='fl'>500</span>, by <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>chr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/chromatogram-method.html'>chromatogram</a></span><span class='op'>(</span><span class='va'>one</span>, mz <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>mzs</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>mzs</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>mzs</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>, include <span class='op'>=</span> <span class='st'>"none"</span>, rt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4000</span>, <span class='fl'>4200</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>joyPlot</span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span>
</div><div class='img'><img src='joyPlot-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## And specyfying a different color for each chromatogram</span>
<span class='fu'>joyPlot</span><span class='op'>(</span><span class='va'>chr</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>heat.colors</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>chr</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='joyPlot-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Finally, creating a plot that looks more like the album cover</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>bg <span class='op'>=</span> <span class='st'>"#000000"</span><span class='op'>)</span>
<span class='fu'>joyPlot</span><span class='op'>(</span><span class='va'>chr</span>, col <span class='op'>=</span> <span class='st'>"#ffffff"</span>, peakBg <span class='op'>=</span> <span class='st'>"#000000aa"</span>, yoffset <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span>
</div><div class='img'><img src='joyPlot-6.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Johannes Rainer, Mar Garcia-Aloy.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9000.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


